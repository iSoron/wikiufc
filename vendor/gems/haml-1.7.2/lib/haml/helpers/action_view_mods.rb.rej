***************
*** 1,11 ****
- begin
-   require 'rubygems'
-   require 'active_support'
-   require 'action_controller'
-   require 'action_view'
-   action_view_included = true
- rescue LoadError
-   action_view_included = false
  end
  
  
--- 1,16 ----
+ 
+ # This obviously requires that ActiveSupport be present prior to Haml
+ # being loaded.
+ action_view_included = false
+ if defined?(ActiveSupport)
+   begin
+     require 'rubygems'
+     require 'active_support'
+     require 'action_controller'
+     require 'action_view'
+     action_view_included = true
+   rescue LoadError
+   end
  end
  
  
